---
title: "Ice Sintering on Europa"
excerpt: "Coupled multiphysics simulations results."
collection: Highlights
---

<div id="plotly-chart" style="width:600px;height:400px;"></div>

<script>
  function initPlotlyHeatmap() {
    console.log('[heatmap] initPlotlyHeatmap() called');

    const container = document.getElementById('plotly-chart');
    if (!container) {
      console.error('[heatmap] ERROR: container #plotly-chart not found');
      return;
    }

    // Quick style check (common failure in themes/layouts)
    const cs = window.getComputedStyle(container);
    console.log('[heatmap] container display:', cs.display, 'width:', cs.width, 'height:', cs.height);
    if (cs.display === 'none' || parseFloat(cs.width) === 0 || parseFloat(cs.height) === 0) {
      container.innerText = 'Plot container is hidden or has zero size (check CSS). See console for details.';
      console.error('[heatmap] container appears hidden or zero-sized. Computed style:', cs);
      // continue — we still attempt to draw so you get console errors if any
    }

    if (typeof Plotly === 'undefined') {
      container.innerText = 'Plotly is not loaded (Plotly is undefined).';
      console.error('[heatmap] ERROR: Plotly is undefined even though onload fired.');
      return;
    }
    console.log('[heatmap] Plotly is present, version:', Plotly.version || 'unknown');

    // Data (copied from the image)
    const z = [
      [91, 58, 32, 14, 3.2],
      [59, 37, 20, 8.4, 1.7],
      [36, 22, 11, 4.8, 1.1],
      [28, 16, 8.3, 3.2, 1.0],
      [23, 13, 6.6, 2.4, 1.0]
    ];
    const x = [0.4, 0.5, 0.6, 0.7, 0.8]; // Albedo A
    const y = [0.9, 0.8, 0.6, 0.4, 0.2]; // Porosity φ

    // heatmap trace
    const heatmap = {
      z: z,
      x: x,
      y: y,
      type: 'heatmap',
      colorscale: 'RdPu',
      zmin: 0,
      zmax: 91,
      hoverongaps: false,
      showscale: true,
      colorbar: { title: ''}
    };

    // annotations (choose black/white text for contrast)
    const maxZ = Math.max(...z.flat());
    const minZ = Math.min(...z.flat());
    const mid = (maxZ + minZ) / 2;
    const annotations = [];
    for (let i = 0; i < y.length; i++) {
      for (let j = 0; j < x.length; j++) {
        const val = z[i][j];
        annotations.push({
          x: x[j],
          y: y[i],
          text: (Number.isInteger(val) ? val : val).toString(),
          showarrow: false,
          font: {
            color: (val > mid ? 'white' : 'black'),
            size: 12
          },
          xref: 'x',
          yref: 'y'
        });
      }
    }

    const layout = {
      title: { text: 'r_b(x = 0, t = t_f) / r_b(x = 0, t = 0)', x: 0.5 },
      xaxis: { title: 'Albedo A' },
      yaxis: { title: 'Porosity φ' },
      annotations: annotations,
      margin: { t: 60, b: 60, l: 70, r: 30 }
    };

    // Try rendering and catch runtime errors
    try {
      Plotly.newPlot(container, [heatmap], layout)
        .then(() => {
          console.log('[heatmap] Plotly.newPlot resolved — plot should be visible.');
          // quick DOM check
          const plotNode = container.querySelector('.js-plotly-plot');
          console.log('[heatmap] js-plotly-plot found?', !!plotNode, plotNode);
        })
        .catch(err => {
          console.error('[heatmap] Plotly.newPlot rejected with error:', err);
          container.innerText = 'Plotly failed to render heatmap — see console for details.';
          // fallback test plot so we can tell whether plotting system works at all
          try {
            Plotly.newPlot(container, [{
              x: [0,1],
              y: [0,1],
              mode: 'markers',
              type: 'scatter'
            }], { title: 'fallback marker test' });
            console.warn('[heatmap] fallback marker test rendered (heatmap failed).');
          } catch (e2) {
            console.error('[heatmap] fallback marker test also failed:', e2);
          }
        });
    } catch (ex) {
      console.error('[heatmap] Exception while calling Plotly.newPlot:', ex);
      container.innerText = 'Exception during plot creation — see console.';
    }
  }
</script>

<script
  src="https://cdn.plot.ly/plotly-latest.min.js"
  onload="initPlotlyHeatmap();"
  onerror="document.getElementById('plotly-chart').innerText='Failed to load Plotly library (network error). Check console.';">
</script>
